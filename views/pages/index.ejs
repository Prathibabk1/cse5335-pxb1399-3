<!DOCTYPE html>
<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
</head>

<body>
<h3> A table</h3>
    
<table id="table1" >
    
    <tr>
        <th>ID</th>
        <th>UNITID</th>
        <th>INSTNM</th>
        <th>ADDR</th>
        <th>CITY</th>
  </tr>
           
    
</table> 
    
    
<script type="text/javascript">
    var th,tr,td1,td2;
    $(document).ready(function(){


    
localStorage.setItem('p','1')
    
var func=setInterval(funcCall,500);
    
    
    
function funcCall(){  
   var counter=localStorage.getItem('p'); 
    
    var count=parseInt(counter);
      
 if(count == 148) {
 
          clearInterval(func);
     } 

	   $.get("/getItems/"+count, function(data){
           
          
         tr="<tr>";
         td1="<td>"+data["ID"]+"</td>";
        td2="<td>"+data["UNITID"]+"</td>";
        td3="<td>"+data["INSTNM"]+"</td>";
        td4="<td>"+data["ADDR"]+"</td>";
        td5="<td>"+data["CITY"]+"</td></tr>";
          $("#table1").append(tr+td1+td2+td3+td4+td5); 
         var rowCount = $('#table1 tr').length; 
        console.log(rowCount);
        if(rowCount>19)
        {
            removeFirstRowAndAppendNewItem(data)
          
        }
           
        function removeFirstRowAndAppendNewItem(data)
        {
          console.log("in callback"); // to confirm we have reached here
            $('tr:first').remove();
          
        }   
           
           
        
         
    
       });

    
    counter=parseInt(counter);
    counter+=1;
    counter=counter.toString();
    
    
    localStorage.setItem('p',counter);
    
}
});

</script>


</body>
</html>
